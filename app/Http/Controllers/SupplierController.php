<?php
namespace App\Http\Controllers; use Illuminate\Http\Request; use App\Repositories\SupplierRepository; class SupplierController extends Controller { protected $SupplierRepository; public function __construct(SupplierRepository $sp877a75) { parent::__construct(); $this->SupplierRepository = $sp877a75; $this->middleware('admin'); $this->middleware('admin.supplier'); } public function getList() { return $this->SupplierRepository->getList(\Input::get('date_start'), \Input::get('date_end')); } public function createSupplier() { $sp68be9c = \Input::get('data'); $sp7612e0 = \Sentinel::getUser(); $sp68be9c['created_by'] = $sp7612e0->email; try { $sp12db67 = $this->SupplierRepository->store($sp68be9c); } catch (\Exception $sp118c46) { return \Response::json(array('type' => 'error', 'message' => $sp118c46->getMessage())); } return \Response::json(array('type' => 'success', 'message' => "Supplier [{$sp12db67->supplier_name}] telah ditambah.")); } public function editSupplier($sp2bf607) { if (!($sp12db67 = $this->SupplierRepository->findById(trim($sp2bf607)))) { return redirect(route('supplier.all'))->with('flashMessage', array('class' => 'danger', 'message' => 'Data supplier tidak ditemukan.')); } return view('supplier.edit')->with('model', $sp12db67); } public function updateSupplier($sp2bf607) { if (!($sp12db67 = $this->SupplierRepository->findById(trim($sp2bf607)))) { return \Response::json(array('type' => 'error', 'message' => "Data supplier #{$sp2bf607} tidak ditemukan.")); } $sp68be9c = \Input::get('data'); try { $sp12db67 = $this->SupplierRepository->update($sp12db67, $sp68be9c); } catch (\Exception $sp118c46) { return \Response::json(array('type' => 'error', 'message' => $sp118c46->getMessage())); } return \Response::json(array('type' => 'success', 'message' => "Data supplier [{$sp12db67->supplier_name}] telah diubah.")); } public function deleteSupplier($sp2bf607) { if (!($sp12db67 = $this->SupplierRepository->findById(trim($sp2bf607)))) { return \Response::json(array('type' => 'error', 'message' => "Data supplier #{$sp2bf607} tidak ditemukan.")); } $sp12db67->delete(); return \Response::json(array('type' => 'success', 'message' => 'Data supplier telah berhasil dihapus.')); } }