<?php
namespace App\Models; use Illuminate\Database\Eloquent\Model; class Sales extends Model { protected $table = 'Sales'; protected $fillable = array(); protected $hidden = array(); protected static $receivableModel = 'App\\Models\\Receivable'; protected static $clientModel = 'App\\Models\\Client'; protected static $itemSalesHistoryModel = 'App\\Models\\ItemSalesHistory'; public function receivable() { return $this->hasOne(static::$receivableModel, 'sales_id'); } public function items() { return $this->hasOne(static::$itemSalesHistoryModel, 'sales_id'); } public function client() { return $this->belongsTo(static::$clientModel, 'client_id'); } public function delete() { $spee7f22 = $this->items()->get(); if (count($spee7f22) > 0) { foreach ($spee7f22 as $spd145cb) { if ($spaa89da = $spd145cb->item) { $spaa89da->stock += $spd145cb->quantity; $spaa89da->save(); } $spd145cb->delete(); } } $this->receivable()->delete(); return parent::delete(); } }